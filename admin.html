<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Focitorna Admin</title>
<style>
body { font-family: Arial; background: #eee; }
.box { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
input, button, select { padding: 8px; margin: 5px; }
.match-row { padding: 6px; border-bottom: 1px solid #ccc; }
</style>
</head>
<body>
<div class="box">
<h1>Admin felület</h1>

<!-- BEJELENTKEZÉS -->
<div id="loginSection">
<h3>Bejelentkezés</h3>
<input id="login_user" placeholder="Felhasználónév"><br>
<input id="login_pass" type="password" placeholder="Jelszó"><br>
<button onclick="handleLogin()">Belépés</button>

<h3>Regisztráció</h3>
<input id="reg_user" placeholder="Új felhasználó"><br>
<input id="reg_pass" type="password" placeholder="Új jelszó"><br>
<button onclick="handleRegister()">Regisztráció</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" style="display:none;">
<button onclick="logout()">Kijelentkezés</button>

<h2>Tornák kezelése</h2>
<input id="tournamentName" placeholder="Torna neve">
<button onclick="addTournament(tournamentName.value)">Torna létrehozása</button>
<div id="tournamentList"></div>

<h2>Csapatok felvitele</h2>
<input id="teamName" placeholder="Csapat neve">
<button onclick="addTeam()">Hozzáadás</button>
<div id="teamList"></div>

<h2>Csoportok kezelése</h2>
<input id="teamPerGroup" type="number" placeholder="Hány csapat / csoport">
<button onclick="createGroups()">Automatikus generálás</button>
<button onclick="manualGroupSetup()">Kézi csoportok szerkesztése</button>
<div id="manualGroups"></div>

<h2>Mérkőzések</h2>
<select id="matchSelect"></select><br>
<input id="scoreA" type="number" placeholder="Hazai gól">
<input id="scoreB" type="number" placeholder="Vendég gól">
<button onclick="saveResult()">Eredmény mentése</button>

<div id="matchList"></div>

<h2>Kieséses szakasz</h2>
<input id="advanceCount" type="number" placeholder="Hány csapat jut tovább">
<button onclick="generateKnockouts()">Kieséses szakasz generálása</button>
<div id="knockoutDisplay"></div>

<button onclick="window.location='index.html'">Nézői felület megnyitása</button>
</div>
</div>

<script src="login.js"></script>
<script src="data.js"></script>

<script>
// --- Login kezelése ---
function updateAdminView() {
    if(getLoggedInUser()){
        document.getElementById("loginSection").style.display="none";
        document.getElementById("adminPanel").style.display="block";
        renderTournamentList();
        renderTeamList();
        fillMatchSelect();
        renderMatchList();
    }
}
updateAdminView();

function logout(){ logoutUser(); location.reload(); }
function handleRegister(){ let r=registerUser(reg_user.value, reg_pass.value); alert(r==="OK"?"Sikeres regisztráció":r); }
function handleLogin(){ let r=loginUser(login_user.value, login_pass.value); if(r==="OK"){updateAdminView();} else alert(r); }

// --- Eredmény mentése ---
function saveResult(){
    const idx = document.getElementById("matchSelect").value;
    const a = parseInt(document.getElementById("scoreA").value);
    const b = parseInt(document.getElementById("scoreB").value);

    if(idx === "" || isNaN(a) || isNaN(b)){
        alert("Hiányzó adat!");
        return;
    }

    saveMatchResult(idx, a, b);
    renderMatchList();
    alert("Eredmény elmentve!");
}
</script>

</body>
</html>
